<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Winter Sorting Hat Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      overflow: hidden; /* убираем скролл и его мигание */
    }
    @keyframes pulse10 {
      0% { transform: scale(1); box-shadow: 0 0 30px rgba(251,191,36,0.7); }
      50% { transform: scale(1.02); box-shadow: 0 0 60px rgba(251,191,36,1); }
      100% { transform: scale(1); box-shadow: 0 0 30px rgba(251,191,36,0.7); }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React + ReactDOM + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState } = React;

    const backgroundUrl = "https://i.postimg.cc/FHkKR4Xm/photo-2025-11-24-14-34-50.jpg";

    const QUESTIONS = [
      {
        text: "When you set off on a trip, you usually",
        options: [
          { id: "A", text: "plan everything in detail", house: "Ravenclaw" },
          { id: "B", text: "take some snacks and go", house: "Slytherin" },
          { id: "C", text: "wait for your friends", house: "Hufflepuff" },
          { id: "D", text: "just go and see what happens", house: "Gryffindor" },
        ],
      },
      {
        text: "You come across a lost puppy in the snow. You",
        options: [
          { id: "A", text: "look for its owner", house: "Ravenclaw" },
          { id: "B", text: "take it home", house: "Slytherin" },
          { id: "C", text: "call your friends to help", house: "Hufflepuff" },
          { id: "D", text: "keep it, you always wanted a puppy", house: "Gryffindor" },
        ],
      },
      {
        text: "You run into a person from your school in town. You",
        options: [
          { id: "A", text: "say hello politely", house: "Ravenclaw" },
          { id: "B", text: "talk for one minute", house: "Slytherin" },
          { id: "C", text: "stop and chat for a long time", house: "Hufflepuff" },
          { id: "D", text: "pretend you didn’t see them", house: "Gryffindor" },
        ],
      },
      {
        text: "You see someone trying to break in to a school building. You",
        options: [
          { id: "A", text: "call an adult", house: "Ravenclaw" },
          { id: "B", text: "watch from a safe place", house: "Slytherin" },
          { id: "C", text: "ask what is happening", house: "Hufflepuff" },
          { id: "D", text: "run away immediately", house: "Gryffindor" },
        ],
      },
      {
        text: "A snowball fight breaks out at school. You",
        options: [
          { id: "A", text: "stay calm and watch", house: "Ravenclaw" },
          { id: "B", text: "join your friends in the fight", house: "Slytherin" },
          { id: "C", text: "start your own team", house: "Hufflepuff" },
          { id: "D", text: "throw the first snowball", house: "Gryffindor" },
        ],
      },
      {
        text: "Holiday snacks suddenly take over the table. You",
        options: [
          { id: "A", text: "organise the snacks nicely", house: "Ravenclaw" },
          { id: "B", text: "try a little bit of everything", house: "Slytherin" },
          { id: "C", text: "call your family to come and eat", house: "Hufflepuff" },
          { id: "D", text: "eat the best things first", house: "Gryffindor" },
        ],
      },
      {
        text: "You feel like you might pass out after running in the cold. You",
        options: [
          { id: "A", text: "breathe slowly and sit down", house: "Ravenclaw" },
          { id: "B", text: "drink some water", house: "Slytherin" },
          { id: "C", text: "ask a friend for help", house: "Hufflepuff" },
          { id: "D", text: "lie on the ground very dramatically", house: "Gryffindor" },
        ],
      },
      {
        text: "What is the hardest thing to get over in winter?",
        options: [
          { id: "A", text: "the cold weather", house: "Ravenclaw" },
          { id: "B", text: "the short days", house: "Slytherin" },
          { id: "C", text: "too much school", house: "Hufflepuff" },
          { id: "D", text: "waking up early", house: "Gryffindor" },
        ],
      },
      {
        text: "You forgot your homework. You need to make up a reason. You",
        options: [
          { id: "A", text: "tell the truth", house: "Ravenclaw" },
          { id: "B", text: "say you were very busy", house: "Slytherin" },
          { id: "C", text: "invent a creative story", house: "Hufflepuff" },
          { id: "D", text: "blame your cat", house: "Gryffindor" },
        ],
      },
      {
        text: "A friend always turns up late to winter meetups. You",
        options: [
          { id: "A", text: "forgive them", house: "Ravenclaw" },
          { id: "B", text: "laugh about it", house: "Slytherin" },
          { id: "C", text: "tell them, 'It’s okay'", house: "Hufflepuff" },
          { id: "D", text: "roll your eyes", house: "Gryffindor" },
        ],
      },
      {
        text: "You want to carry on with a project, but you feel tired. You",
        options: [
          { id: "A", text: "make a simple plan", house: "Ravenclaw" },
          { id: "B", text: "turn on some music", house: "Slytherin" },
          { id: "C", text: "ask friends to help you", house: "Hufflepuff" },
          { id: "D", text: "take a long break first", house: "Gryffindor" },
        ],
      },
      {
        text: "You are trying to figure out a new winter recipe. You",
        options: [
          { id: "A", text: "follow the instructions exactly", house: "Ravenclaw" },
          { id: "B", text: "try the easy steps first", house: "Slytherin" },
          { id: "C", text: "ask someone to help you", house: "Hufflepuff" },
          { id: "D", text: "just guess and hope it works", house: "Gryffindor" },
        ],
      },
    ];

    const HOUSE_TEXT = {
      Gryffindor: {
        title: "Gryffindor",
        crest: "https://i.postimg.cc/nV6mG0FP/photo-2025-11-24-14-40-32.jpg",
        speech:
          '"Oh! A brave one! You jump into new things so fast, you just run into every adventure. You carry on, even when it is difficult. You can make up fun ideas and jump into adventures. Well then… no fear, no doubts… GRYFFINDOR!"',
      },
      Slytherin: {
        title: "Slytherin",
        crest: "https://i.postimg.cc/KcKLTd2W/photo-2025-11-24-14-41-13.jpg",
        speech:
          '"Oh, interesting… very interesting. You always turn up with a quick idea. You like to take over when things get messy. Smart, fast, confident… yes, I see your style. No doubt about it… SLYTHERIN!"',
      },
      Hufflepuff: {
        title: "Hufflepuff",
        crest: "https://i.postimg.cc/zD9hF0z2/photo-2025-11-24-14-42-30.jpg",
        speech:
          '"Ahh… such a warm heart. You always try to help, to stay kind, to carry on with friends. Even when things are hard to get over, you stay calm. So patient… so gentle… I don’t need more time for this one. HUFFLEPUFF!"',
      },
      Ravenclaw: {
        title: "Ravenclaw",
        crest: "https://i.postimg.cc/3rPGFn8P/photo-2025-11-24-14-43-20.jpg",
        speech:
          '"Hmm… let me think… yes, yes… I can see it now. You like to think first, don’t you? Always trying to figure out every little detail. You like to set off with a clear plan, not with chaos. Very clever, very calm… Oh, I know exactly where you belong. RAVENCLAW!"',
      },
    };

    function SortingHatQuiz() {
      const [step, setStep] = useState("welcome"); // "welcome" | "quiz" | "result"
      const [currentIndex, setCurrentIndex] = useState(0);
      const [scores, setScores] = useState({
        Ravenclaw: 0,
        Slytherin: 0,
        Hufflepuff: 0,
        Gryffindor: 0,
      });
      const [resultHouse, setResultHouse] = useState(null);
      const [clickedOption, setClickedOption] = useState(null);

      const handleBegin = () => {
        setStep("quiz");
      };

      const handleAnswer = (house, optionId) => {
        setClickedOption(optionId);

        setTimeout(() => {
          setScores((prev) => {
            const next = { ...prev, [house]: prev[house] + 1 };

            const isLast = currentIndex === QUESTIONS.length - 1;
            if (isLast) {
              const entries = Object.entries(next);
              let bestHouse = entries[0][0];
              let bestScore = entries[0][1];
              for (const [h, s] of entries.slice(1)) {
                if (s > bestScore) {
                  bestScore = s;
                  bestHouse = h;
                }
              }
              setResultHouse(bestHouse);
              setStep("result");
            } else {
              setCurrentIndex((i) => i + 1);
            }
            return next;
          });

          setClickedOption(null);
        }, 160);
      };

      const handleRestart = () => {
        setStep("welcome");
        setCurrentIndex(0);
        setScores({
          Ravenclaw: 0,
          Slytherin: 0,
          Hufflepuff: 0,
          Gryffindor: 0,
        });
        setResultHouse(null);
        setClickedOption(null);
      };

      const currentQuestion = QUESTIONS[currentIndex];

      return (
        <div
          className="w-full h-screen flex items-center justify-center bg-cover bg-center bg-no-repeat"
          style={{ backgroundImage: `url(${backgroundUrl})` }}
        >
          <div className="w-full h-full bg-black/25 flex items-center justify-end pr-4 md:pr-16">
            <div
              className="flex flex-col gap-4 items-stretch text-[18px] sm:text-[20px] text-amber-50"
              style={{ width: "min(42vw, 640px)" }}
            >
              {step === "welcome" && (
                <div className="rounded-3xl border border-amber-200/70 bg-slate-950/70 backdrop-blur-xl shadow-[0_0_40px_rgba(0,0,0,0.8)] px-6 py-6 md:px-8 md:py-8">
                  <h1 className="text-3xl md:text-4xl font-extrabold mb-3 drop-shadow-[0_0_20px_rgba(0,0,0,0.9)]">
                    Sorting Hat
                  </h1>
                  <p className="leading-relaxed mb-3">
                    Answer the questions and let the magic hat find your Hogwarts
                    house. Be honest, be yourself, and follow your winter wizard
                    heart.
                  </p>
                  <p className="leading-relaxed mb-4">
                    One question at a time. Choose the answer that is most like
                    you.
                  </p>
                  <button
                    onClick={handleBegin}
                    className="inline-flex items-center justify-center rounded-full px-8 py-3 text-xl font-semibold bg-amber-300 text-slate-900 shadow-lg shadow-amber-400/60 hover:bg-amber-200 active:scale-95 transition"
                  >
                    Begin the Sorting
                  </button>
                </div>
              )}

              {step === "quiz" && (
                <>
                  <div className="rounded-[32px] border border-amber-200/70 bg-white/18 backdrop-blur-xl px-6 py-5 md:px-8 md:py-6 shadow-[0_0_40px_rgba(0,0,0,0.8)] relative overflow-hidden">
                    <div className="pointer-events-none absolute inset-0 bg-gradient-to-br from-white/15 via-transparent to-amber-300/20" />
                    <div className="relative">
                      <div className="text-sm tracking-[0.25em] uppercase text-amber-100/80 mb-2">
                        Question {currentIndex + 1} of {QUESTIONS.length}
                      </div>
                      <p className="text-2xl font-semibold leading-snug">
                        {currentQuestion.text}
                      </p>
                    </div>
                  </div>

                  <div className="flex flex-col gap-3">
                    {currentQuestion.options.map((opt) => {
                      const isClicked = clickedOption === opt.id;
                      return (
                        <button
                          key={opt.id}
                          onClick={() => handleAnswer(opt.house, opt.id)}
                          className={
                            "relative overflow-hidden w-full text-left rounded-3xl bg-slate-950/70 border border-cyan-200/50 px-5 py-3 md:px-6 md:py-4 flex gap-4 items-center shadow-[0_0_30px_rgba(0,0,0,0.9)] hover:border-amber-200 hover:bg-slate-950/90 hover:shadow-amber-300/40 transition-transform duration-150 " +
                            (isClicked ? "scale-95" : "hover:scale-105")
                          }
                        >
                          {isClicked && (
                            <>
                              <span className="pointer-events-none absolute -left-4 -top-4 w-10 h-10 rounded-full bg-amber-300/40 blur-md animate-ping" />
                              <span className="pointer-events-none absolute right-0 -bottom-4 w-8 h-8 rounded-full bg-cyan-300/40 blur-md animate-ping" />
                            </>
                          )}
                          <span className="flex h-9 w-9 items-center justify-center rounded-full bg-amber-300 text-slate-900 text-base font-bold shadow-md shadow-amber-400/70">
                            {opt.id}
                          </span>
                          <span className="text-xl leading-snug text-amber-50">
                            {opt.text}
                          </span>
                        </button>
                      );
                    })}
                  </div>
                </>
              )}

              {step === "result" && resultHouse && (
                <div className="flex flex-col gap-6 items-center w-full">
                  <div className="relative aspect-square flex items-center justify-center" style={{ width: "min(38vw, 420px)", height: "min(38vw, 420px)" }}>
                    <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
                      <span className="absolute w-full h-full rounded-full bg-amber-300/10 blur-3xl animate-ping" />
                      <span className="absolute w-3/4 h-3/4 rounded-full bg-amber-400/15 blur-2xl" />
                    </div>
                    <img
                      src={HOUSE_TEXT[resultHouse].crest}
                      alt={HOUSE_TEXT[resultHouse].title}
                      className="w-full h-full object-cover rounded-3xl"
                      style={{ animation: "pulse10 10s ease-out infinite" }}
                    />
                  </div>

                  <div className="rounded-3xl bg-slate-950/90 px-6 py-6 flex flex-col items-center gap-3 shadow-[0_0_35px_rgba(0,0,0,0.95)]">
                    <div className="text-xs tracking-[0.25em] uppercase text-amber-100/80 text-center">
                      The Sorting Hat has decided…
                    </div>
                    <p className="text-xl leading-relaxed text-center whitespace-pre-line">
                      {HOUSE_TEXT[resultHouse].speech}
                    </p>
                  </div>

                  <button
                    onClick={handleRestart}
                    className="mt-2 inline-flex items-center justify-center rounded-full px-8 py-3 text-xl font-semibold bg-slate-100 text-slate-900 shadow-lg border border-amber-300 hover:bg-amber-200 active:scale-95 transition"
                  >
                    Try again
                  </button>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<SortingHatQuiz />);
  </script>
</body>
</html>
